metadata:
  name: "Ensure SQS queue is encrypted using KMS"
  id: "CUSTOM_SQS_ENCRYPTION"
  category: "encryption"
  severity: "HIGH"

scope:
  provider: aws
  resource_types:
    - aws_sqs_queue
    
definition:
  and: 
    - cond_type: "resource_type"
      resource_types:
        - "aws_sqs_queue"

    - cond_type: "attribute"
      attribute: "kms_master_key_id"
      operator: "exists"
