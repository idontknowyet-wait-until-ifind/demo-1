metadata:
  name: "Ensure SQS message retention is no more than 7 days"
  id: "CUSTOM_SQS_RETENTION"
  category: "performance"
  severity: "LOW"

scope:
  provider: aws
  resource_types:
    - aws_sqs_queue
    
definition:
  add:
    - cond_type: "resource_type"
      resource_types: 
        - "aws_sqs_queue"
    - cond_type: "attribute"
      attribute: "message_retention_seconds"
      operator: "less_than_or_equal"
      value: 604800  # 7 days in seconds
