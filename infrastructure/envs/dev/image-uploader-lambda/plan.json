{"format_version":"1.2","terraform_version":"1.12.2","variables":{"attach_basic_execution_role":{"value":true},"create_role":{"value":"false"},"custom_vpc_enabled":{"value":"false"},"enable_function_url":{"value":"true"},"enabled_event_source_mapping":{"value":false},"environment_variables":{"value":{"ENV":"dev"}},"event_source_arn":{"value":""},"filename":{"value":null},"function_url_auth_type":{"value":"NONE"},"handler":{"value":null},"image_uri":{"value":"000000000000.dkr.ecr.us-east-1.localhost.localstack.cloud:4566/demo-lambda:latest"},"layers":{"value":[]},"memory_size":{"value":128},"name":{"value":"image-upload-function"},"role_arn":{"value":"arn:aws:iam::000000000000:role/from-sqs-to-lambda"},"runtime":{"value":null},"s3_bucket":{"value":null},"s3_key":{"value":null},"security_group_ids":{"value":[]},"source_code_hash":{"value":null},"subnet_ids":{"value":[]},"tags":{"value":{}},"timeout":{"value":10},"use_image":{"value":"true"}},"planned_values":{"outputs":{"lambda_arn":{"sensitive":false},"lambda_function_name":{"sensitive":false,"type":"string","value":"image-upload-function"},"lambda_function_url":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_lambda_function.this","mode":"managed","type":"aws_lambda_function","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"ENV":"dev"}}],"file_system_config":[],"filename":null,"function_name":"image-upload-function","handler":null,"image_config":[],"image_uri":"000000000000.dkr.ecr.us-east-1.localhost.localstack.cloud:4566/demo-lambda:latest","kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Image","publish":false,"region":"us-east-1","replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"role":"arn:aws:iam::000000000000:role/from-sqs-to-lambda","runtime":null,"s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"tags":null,"timeout":10,"timeouts":null,"vpc_config":[]},"sensitive_values":{"architectures":[],"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":[],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags_all":{},"tracing_config":[],"vpc_config":[]}},{"address":"aws_lambda_function_url.this[0]","mode":"managed","type":"aws_lambda_function_url","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"authorization_type":"NONE","cors":[{"allow_credentials":null,"allow_headers":["*"],"allow_methods":["*"],"allow_origins":["*"],"expose_headers":null,"max_age":null}],"function_name":"image-upload-function","invoke_mode":"BUFFERED","qualifier":null,"region":"us-east-1","timeouts":null},"sensitive_values":{"cors":[{"allow_headers":[false],"allow_methods":[false],"allow_origins":[false]}]}},{"address":"aws_lambda_permission.allow_public_url[0]","mode":"managed","type":"aws_lambda_permission","name":"allow_public_url","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"action":"lambda:InvokeFunctionUrl","event_source_token":null,"function_name":"image-upload-function","function_url_auth_type":null,"principal":"*","principal_org_id":null,"qualifier":null,"region":"us-east-1","source_account":null,"source_arn":null,"statement_id":"AllowPublicFunctionUrl"},"sensitive_values":{}}]}},"resource_changes":[{"address":"aws_lambda_function.this","mode":"managed","type":"aws_lambda_function","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"ENV":"dev"}}],"file_system_config":[],"filename":null,"function_name":"image-upload-function","handler":null,"image_config":[],"image_uri":"000000000000.dkr.ecr.us-east-1.localhost.localstack.cloud:4566/demo-lambda:latest","kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Image","publish":false,"region":"us-east-1","replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"role":"arn:aws:iam::000000000000:role/from-sqs-to-lambda","runtime":null,"s3_bucket":null,"s3_key":null,"s3_object_version":null,"skip_destroy":false,"snap_start":[],"tags":null,"timeout":10,"timeouts":null,"vpc_config":[]},"after_unknown":{"architectures":true,"arn":true,"code_sha256":true,"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":true,"file_system_config":[],"id":true,"image_config":[],"invoke_arn":true,"last_modified":true,"logging_config":true,"qualified_arn":true,"qualified_invoke_arn":true,"signing_job_arn":true,"signing_profile_version_arn":true,"snap_start":[],"source_code_hash":true,"source_code_size":true,"tags_all":true,"tracing_config":true,"version":true,"vpc_config":[]},"before_sensitive":false,"after_sensitive":{"architectures":[],"dead_letter_config":[],"environment":[{"variables":{}}],"ephemeral_storage":[],"file_system_config":[],"image_config":[],"logging_config":[],"snap_start":[],"tags_all":{},"tracing_config":[],"vpc_config":[]}}},{"address":"aws_lambda_function_url.this[0]","mode":"managed","type":"aws_lambda_function_url","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"authorization_type":"NONE","cors":[{"allow_credentials":null,"allow_headers":["*"],"allow_methods":["*"],"allow_origins":["*"],"expose_headers":null,"max_age":null}],"function_name":"image-upload-function","invoke_mode":"BUFFERED","qualifier":null,"region":"us-east-1","timeouts":null},"after_unknown":{"cors":[{"allow_headers":[false],"allow_methods":[false],"allow_origins":[false]}],"function_arn":true,"function_url":true,"id":true,"url_id":true},"before_sensitive":false,"after_sensitive":{"cors":[{"allow_headers":[false],"allow_methods":[false],"allow_origins":[false]}]}}},{"address":"aws_lambda_permission.allow_public_url[0]","mode":"managed","type":"aws_lambda_permission","name":"allow_public_url","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"action":"lambda:InvokeFunctionUrl","event_source_token":null,"function_name":"image-upload-function","function_url_auth_type":null,"principal":"*","principal_org_id":null,"qualifier":null,"region":"us-east-1","source_account":null,"source_arn":null,"statement_id":"AllowPublicFunctionUrl"},"after_unknown":{"id":true,"statement_id_prefix":true},"before_sensitive":false,"after_sensitive":{}}}],"output_changes":{"lambda_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"lambda_function_name":{"actions":["create"],"before":null,"after":"image-upload-function","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"lambda_function_url":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.12.2","values":{"outputs":{"lambda_function_name":{"sensitive":false,"value":"image-upload-function","type":"string"}},"root_module":{}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","expressions":{"access_key":{"constant_value":"mock"},"endpoints":[{"ec2":{"constant_value":"http://localstack:4566"},"iam":{"constant_value":"http://localstack:4566"},"lambda":{"constant_value":"http://localstack:4566"},"rds":{"constant_value":"http://localstack:4566"},"s3":{"constant_value":"http://localstack:4566"},"sqs":{"constant_value":"http://localstack:4566"},"sts":{"constant_value":"http://localstack:4566"}}],"region":{"constant_value":"us-east-1"},"s3_use_path_style":{"constant_value":true},"secret_key":{"constant_value":"mock"},"skip_credentials_validation":{"constant_value":true},"skip_metadata_api_check":{"constant_value":true},"skip_requesting_account_id":{"constant_value":true}}}},"root_module":{"outputs":{"lambda_arn":{"expression":{"references":["aws_lambda_function.this.arn","aws_lambda_function.this"]}},"lambda_function_name":{"expression":{"references":["aws_lambda_function.this.function_name","aws_lambda_function.this"]}},"lambda_function_url":{"expression":{"references":["var.enable_function_url","aws_lambda_function_url.this[0].function_url","aws_lambda_function_url.this[0]","aws_lambda_function_url.this"]},"description":"The URL to invoke the Lambda Function (if enabled)"}},"resources":[{"address":"aws_iam_role.lambda_exec","mode":"managed","type":"aws_iam_role","name":"lambda_exec","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]}},"schema_version":0,"count_expression":{"references":["var.create_role"]}},{"address":"aws_iam_role_policy_attachment.basic","mode":"managed","type":"aws_iam_role_policy_attachment","name":"basic","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"},"role":{"references":["aws_iam_role.lambda_exec[0].name","aws_iam_role.lambda_exec[0]","aws_iam_role.lambda_exec"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.attach_basic_execution_role"]}},{"address":"aws_lambda_event_source_mapping.sqs_trigger","mode":"managed","type":"aws_lambda_event_source_mapping","name":"sqs_trigger","provider_config_key":"aws","expressions":{"batch_size":{"constant_value":10},"enabled":{"constant_value":true},"event_source_arn":{"references":["var.event_source_arn"]},"function_name":{"references":["aws_lambda_function.this.function_name","aws_lambda_function.this"]}},"schema_version":0,"count_expression":{"references":["var.enabled_event_source_mapping"]}},{"address":"aws_lambda_function.this","mode":"managed","type":"aws_lambda_function","name":"this","provider_config_key":"aws","expressions":{"environment":[{"variables":{"references":["var.environment_variables"]}}],"filename":{"references":["var.use_image","var.filename"]},"function_name":{"references":["var.name"]},"handler":{"references":["var.use_image","var.handler"]},"image_uri":{"references":["var.use_image","var.image_uri"]},"layers":{"references":["var.use_image","var.layers"]},"memory_size":{"references":["var.memory_size"]},"package_type":{"references":["var.use_image"]},"role":{"references":["var.create_role","aws_iam_role.lambda_exec[0].arn","aws_iam_role.lambda_exec[0]","aws_iam_role.lambda_exec","var.role_arn"]},"runtime":{"references":["var.use_image","var.runtime"]},"s3_bucket":{"references":["var.use_image","var.s3_bucket"]},"s3_key":{"references":["var.use_image","var.s3_key"]},"source_code_hash":{"references":["var.use_image","var.source_code_hash"]},"tags":{"references":["var.tags"]},"timeout":{"references":["var.timeout"]}},"schema_version":0},{"address":"aws_lambda_function_url.this","mode":"managed","type":"aws_lambda_function_url","name":"this","provider_config_key":"aws","expressions":{"authorization_type":{"references":["var.function_url_auth_type"]},"cors":[{"allow_headers":{"constant_value":["*"]},"allow_methods":{"constant_value":["*"]},"allow_origins":{"constant_value":["*"]}}],"function_name":{"references":["aws_lambda_function.this.function_name","aws_lambda_function.this"]}},"schema_version":0,"count_expression":{"references":["var.enable_function_url"]}},{"address":"aws_lambda_permission.allow_public_url","mode":"managed","type":"aws_lambda_permission","name":"allow_public_url","provider_config_key":"aws","expressions":{"action":{"constant_value":"lambda:InvokeFunctionUrl"},"function_name":{"references":["aws_lambda_function.this.function_name","aws_lambda_function.this"]},"principal":{"constant_value":"*"},"statement_id":{"constant_value":"AllowPublicFunctionUrl"}},"schema_version":0,"count_expression":{"references":["var.enable_function_url","var.function_url_auth_type"]}}],"variables":{"attach_basic_execution_role":{"default":true,"description":"Whether to attach AWSLambdaBasicExecutionRole"},"create_role":{"default":true,"description":"Whether the module should create an IAM role for Lambda execution"},"custom_vpc_enabled":{"default":false,"description":"Whether to deploy the Lambda into a custom VPC"},"enable_function_url":{"default":false,"description":"Whether to create a Function URL for the Lambda"},"enabled_event_source_mapping":{"default":false,"description":"Optional bool for enabling event source mapper, making lambda to read from event source like sqs"},"environment_variables":{"default":{},"description":"Environment variables for the Lambda"},"event_source_arn":{"default":"","description":"event source arn like sqs arn"},"filename":{"default":null,"description":"Local ZIP file path for deployment"},"function_url_auth_type":{"default":"NONE","description":"Auth type for the Lambda Function URL (e.g., NONE or AWS_IAM)"},"handler":{"default":null,"description":"Function entrypoint (e.g. index.handler)"},"image_uri":{"default":null,"description":"ECR image URI for container-based Lambda"},"layers":{"default":[],"description":"Optional Lambda layers"},"memory_size":{"default":128,"description":"Memory allocated to Lambda in MB"},"name":{"description":"Name of the Lambda function"},"role_arn":{"default":null,"description":"Optional ARN of an existing IAM role to use instead of creating one"},"runtime":{"default":null,"description":"Lambda runtime (e.g. python3.10)"},"s3_bucket":{"default":null,"description":"S3 bucket for ZIP file"},"s3_key":{"default":null,"description":"S3 key for ZIP file"},"security_group_ids":{"default":[],"description":"Security groups for the Lambda (if custom VPC is enabled)"},"source_code_hash":{"default":null,"description":"Base64-encoded SHA256 hash of the deployment package"},"subnet_ids":{"default":[],"description":"Subnets to attach Lambda to (if custom VPC is enabled)"},"tags":{"default":{},"description":"Tags to apply to all resources"},"timeout":{"default":10,"description":"Function timeout in seconds"},"use_image":{"default":false,"description":"Set to true if using container image-based deployment"}}}},"relevant_attributes":[{"resource":"aws_iam_role.lambda_exec[0]","attribute":["arn"]},{"resource":"aws_lambda_function.this","attribute":["arn"]},{"resource":"aws_lambda_function.this","attribute":["function_name"]},{"resource":"aws_lambda_function_url.this[0]","attribute":["function_url"]}],"timestamp":"2025-07-02T08:10:11Z","applyable":true,"complete":true,"errored":false}
